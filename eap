forbid_eap {
	if (&EAP-Message) {
		reject
	}
}

permit_only_eap {
	if (!&EAP-Message) {

		if (!&outer.request || !&outer.request:EAP-Message) {
			reject
		}
	}
}

remove_reply_message_if_eap {
	if (&reply:EAP-Message && &reply:Reply-Message) {
		update reply {
			&Reply-Message !* ANY
		}
	}
	else {
		noop
	}
}

verify_tls_client_common_name {
	if ((&User-Name !~ /^@/) && &TLS-Client-Cert-Common-Name && (&TLS-Client-Cert-Common-Name != &User-Name)) {
		reject
	}
}